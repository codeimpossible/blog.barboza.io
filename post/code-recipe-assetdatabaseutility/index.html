<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    
    <meta itemprop="name" content="Code Recipe: AssetDatabaseUtility | blog.barboza.io">
    <meta itemprop="description" content="üçï P I Z Z A is life">

    
    <meta name="twitter:title" content="Code Recipe: AssetDatabaseUtility | blog.barboza.io">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="üçï P I Z Z A is life">
    <meta name="twitter:site" content="@codeimpossible">
    <meta name="twitter:creator" content="@codeimpossible">
    <meta name="twitter:image:src" content="http://blog.barboza.io/social-header.png">

    
    <meta name="og:title" content="Code Recipe: AssetDatabaseUtility | blog.barboza.io">
    <meta name="og:description" content="üçï P I Z Z A is life">
    <meta name="og:image" content="http://blog.barboza.io/social-header-lg.png">
    <meta name="og:url" content="http://blog.barboza.io/">
    <meta name="og:site_name" content="blog.barboza.io">
    <meta name="og:locale" content="en_US">
    <meta name="og:type" content="website">

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <title>Code Recipe: AssetDatabaseUtility‚Äîblog.barboza.io</title>

    <link rel="stylesheet" href="/assets/main.bundle.css">

    
  </head>
  <body class="flex flex-col min-h-screen is-post">
    <main class="container mx-auto max-w-3xl flex-grow">
      <aside class="intro">
  <a href="/">
    <img src="/me.jpg" alt="Me. I mean Jared. I mean that's me, Jared." class="rounded-full" />
  </a>
  <div class="intro-greeting mb-5">
    <h1>Hey there üëã, I'm Jared.</h1>
    <h2>Future skeleton. üêà parent. Lover of all things üçï. Dispenser of artisanal emoji, gifs and memes. They/Them.</h2>
  </div>
  <span class="social">
      <a href="https://twitter.com/codeimpossible" class="social_icon icon-twitter" title="@codeimpossible on Twitter">
          <svg width="28" height="28" viewBox="0 0 32 32" preserveAspectRatio="xMinYMin" aria-hidden="true" focusable="false">
              <use xlink:href="#icon-twitter">
                  <g id="icon-twitter"><path fill="#00c9ff" d="M 32,6.076c-1.177,0.522-2.443,0.875-3.771,1.034c 1.355-0.813, 2.396-2.099, 2.887-3.632 c-1.269,0.752-2.674,1.299-4.169,1.593c-1.198-1.276-2.904-2.073-4.792-2.073c-3.626,0-6.565,2.939-6.565,6.565 c0,0.515, 0.058,1.016, 0.17,1.496c-5.456-0.274-10.294-2.888-13.532-6.86c-0.565,0.97-0.889,2.097-0.889,3.301 c0,2.278, 1.159,4.287, 2.921,5.465c-1.076-0.034-2.088-0.329-2.974-0.821c-0.001,0.027-0.001,0.055-0.001,0.083 c0,3.181, 2.263,5.834, 5.266,6.438c-0.551,0.15-1.131,0.23-1.73,0.23c-0.423,0-0.834-0.041-1.235-0.118 c 0.836,2.608, 3.26,4.506, 6.133,4.559c-2.247,1.761-5.078,2.81-8.154,2.81c-0.53,0-1.052-0.031-1.566-0.092 c 2.905,1.863, 6.356,2.95, 10.064,2.95c 12.076,0, 18.679-10.004, 18.679-18.68c0-0.285-0.006-0.568-0.019-0.849 C 30.007,8.548, 31.12,7.392, 32,6.076z"></path></g>
              </use>
          </svg>
          <span class="a11y-only">Twitter</span>
      </a> 
      <a href="https://github.com/codeimpossible/" class="social_icon icon-github" title="@codeimpossible on GitHub">
          <svg width="28" height="28" viewBox="0 0 32 32" preserveAspectRatio="xMinYMin" aria-hidden="true" focusable="false">
              <use xlink:href="#icon-github">
                  <g id="icon-github"><path fill="#000000" d="M 16,0C 7.163,0,0,7.163,0,16s 7.163,16, 16,16s 16-7.163, 16-16S 24.837,0, 16,0z M 25.502,25.502 c-1.235,1.235-2.672,2.204-4.272,2.881c-0.406,0.172-0.819,0.323-1.238,0.453L 19.992,26.438 c0-1.26-0.432-2.188-1.297-2.781 c 0.542-0.052, 1.039-0.125, 1.492-0.219s 0.932-0.229, 1.438-0.406s 0.958-0.388, 1.359-0.633s 0.786-0.563, 1.156-0.953s 0.68-0.833, 0.93-1.328 s 0.448-1.089, 0.594-1.781s 0.219-1.456, 0.219-2.289c0-1.615-0.526-2.99-1.578-4.125c 0.479-1.25, 0.427-2.609-0.156-4.078l-0.391-0.047 c-0.271-0.031-0.758,0.083-1.461,0.344s-1.492,0.688-2.367,1.281c-1.24-0.344-2.526-0.516-3.859-0.516c-1.344,0-2.625,0.172-3.844,0.516 c-0.552-0.375-1.075-0.685-1.57-0.93c-0.495-0.245-0.891-0.411-1.188-0.5s-0.573-0.143-0.828-0.164s-0.419-0.026-0.492-0.016 s-0.125,0.021-0.156,0.031c-0.583,1.479-0.635,2.839-0.156,4.078c-1.052,1.135-1.578,2.51-1.578,4.125c0,0.833, 0.073,1.596, 0.219,2.289 s 0.344,1.286, 0.594,1.781s 0.56,0.938, 0.93,1.328s 0.755,0.708, 1.156,0.953s 0.854,0.456, 1.359,0.633s 0.984,0.313, 1.438,0.406 s 0.951,0.167, 1.492,0.219c-0.854,0.583-1.281,1.51-1.281,2.781l0,2.445 c-0.472-0.14-0.937-0.306-1.394-0.5 c-1.6-0.677-3.037-1.646-4.272-2.881c-1.235-1.235-2.204-2.672-2.881-4.272C 2.917,19.575, 2.563,17.815, 2.563,16 s 0.355-3.575, 1.055-5.23c 0.677-1.6, 1.646-3.037, 2.881-4.272s 2.672-2.204, 4.272-2.881 C 12.425,2.917, 14.185,2.563, 16,2.563s 3.575,0.355, 5.23,1.055c 1.6,0.677, 3.037,1.646, 4.272,2.881 c 1.235,1.235, 2.204,2.672, 2.881,4.272C 29.083,12.425, 29.438,14.185, 29.438,16s-0.355,3.575-1.055,5.23 C 27.706,22.829, 26.737,24.267, 25.502,25.502z"></path></g>
              </use>
          </svg>
          <span class="a11y-only">GitHub</span>
      </a> 
      <a href="/feed/" class="social_icon icon-rss" title="Jared Barboza's RSS Feed">
          <svg width="28" height="28" viewBox="0 0 32 32" preserveAspectRatio="xMinYMin" aria-hidden="true" focusable="false">
              <use xlink:href="#icon-feed">
                  <g id="icon-feed"><path fill="#ff9132" d="M 4.259,23.467c-2.35,0-4.259,1.917-4.259,4.252c0,2.349, 1.909,4.244, 4.259,4.244 c 2.358,0, 4.265-1.895, 4.265-4.244C 8.525,25.383, 6.618,23.467, 4.259,23.467zM 0.005,10.873l0,6.133 c 3.993,0, 7.749,1.562, 10.577,4.391c 2.825,2.822, 4.384,6.595, 4.384,10.603l 6.16,0 C 21.125,20.349, 11.648,10.873, 0.005,10.873zM 0.012,0l0,6.136 c 14.243,0, 25.836,11.604, 25.836,25.864L 32,32 C 32,14.36, 17.648,0, 0.012,0z"></path></g>
              </use>
          </svg>
          <span class="a11y-only">RSS</span>
      </a>
  </span>
</aside>
      
    <div>
        <h1>Code Recipe: AssetDatabaseUtility</h1>

        

        
            <span class="text-sm">üìÜ <em>Created on
                    <span datetime="Sat Sep 30 2023 02:29:02 GMT+0000 (Coordinated Universal Time)">September 30, 2023</span>.</em></span>
        

        
            <span class="pl-10 mb-2 tags">
                <span>üîñ</span>
                <a class="tag tag-inline" href="/tag/programming">programming</a><a class="tag tag-inline" href="/tag/unity3d">unity3d</a><a class="tag tag-inline" href="/tag/unity-editor">unity-editor</a>
            </span>
        

        <div class="content post">
            <p>Working in Unity can be a frustrating endeavor, especially when working with the <code>AssetDatabase</code>. It's public methods just aren't all that helpful, at least in most of the cases where I've needed to use it.</p>
<p>So I've built out a helper class that makes working with assets a lot easier and I wanted to open source it in the hopes that maybe someone else finds it useful one day.</p>
<h2>AssetDatabaseUtility</h2>
<p>You can check out the code <a href="https://github.com/troublecatstudios/noir-unity/blob/stable/Editor/AssetDatabaseUtility.cs">here, in the Noir.Unity</a> project. It's MIT licensed so please use it or remix it as you need.</p>
<p>The class has three methods, each of which are pretty well documented both in the code and on the <a href="https://troublecatstudios.github.io/noir-unity/api/NoirUnityEditor.AssetDatabaseUtility.html">docs site for the library</a>, but I'll give a quick overview of them here.</p>
<h3><a href="https://troublecatstudios.github.io/noir-unity/api/NoirUnityEditor.AssetDatabaseUtility.html#NoirUnityEditor_AssetDatabaseUtility_Mkdirp_System_String_">Mkdirp(String)</a></h3>
<p>If you've used the command line <code>mkdir -p</code> then you know what this does. It takes a relative path like <code>some/path/to/some/thing</code> and ensures it's full hierarchy is created within the <code>Assets/</code> folder.</p>
<h3><a href="NoirUnityEditor_AssetDatabaseUtility_TryGetReferencesToObject_UnityEngine_Object_System_Collections_Generic_IEnumerable_System_String___">TryGetReferencesToObject(UnityEngine.Object, out IEnumerable<String>)</a></h3>
<p>This method searches through the asset database looking for any asset that has a reference to the given GameObject. The path to each asset file will be returned in the IEnumerable. This does read the contents of all the assets on the disk, so definitely cache the results and don't call this in a loop.</p>
<p>This is really useful if you're using scriptable objects as data containers or event messages. You can find out exactly which objects have a reference to in the editor so you can know if an event is safe to delete or what needs to be tested if you change a weapon.</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RenderMetadata</span><span class="token punctuation">(</span><span class="token class-name">NoirGameEvent</span> ev<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  EditorGUI<span class="token punctuation">.</span>indentLevel<span class="token operator">++</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>AssetDatabase<span class="token punctuation">.</span><span class="token function">TryGetGUIDAndLocalFileIdentifier</span><span class="token punctuation">(</span>ev<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> guid<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">long</span></span> localId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">EditorGUILayout<span class="token punctuation">.</span>HorizontalScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">EditorGUILayout<span class="token punctuation">.</span>VerticalScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        EditorGUILayout<span class="token punctuation">.</span><span class="token function">SelectableLabel</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"ID: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">guid</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        EditorGUILayout<span class="token punctuation">.</span><span class="token function">SelectableLabel</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Local ID: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">localId</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"Refresh Consumers"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><br>          AssetDatabaseUtility<span class="token punctuation">.</span><span class="token function">TryGetReferencesToObject</span><span class="token punctuation">(</span>ev<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> usedBy<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>_eventUsedByTracker<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>guid<span class="token punctuation">)</span><span class="token punctuation">)</span><br>                _eventUsedByTracker<span class="token punctuation">[</span>guid<span class="token punctuation">]</span> <span class="token operator">=</span> usedBy<span class="token punctuation">;</span><br>            <span class="token keyword">else</span> _eventUsedByTracker<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>guid<span class="token punctuation">,</span> usedBy<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  EditorGUI<span class="token punctuation">.</span>indentLevel<span class="token operator">--</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<img src="/electricnoir/inspector-game-events.png" />
<h3><a href="https://troublecatstudios.github.io/noir-unity/api/NoirUnityEditor.AssetDatabaseUtility.html#NoirUnityEditor_AssetDatabaseUtility_Load__1_System_String_System_Func_System_String_System_Boolean__System_String___">Load<T>(String, Func&lt;String, Boolean&gt;, String[])</a></h3>
<p>This method is the first method I wrote for the helper and it's definitely the most used out of all of them in my projects. This searches the asset database for assets of a certain type, loads them and returns them. You can filter the results a few different ways:</p>
<ol>
<li>Passing a search query. Any query from the search field in the project tab will work.</li>
<li>Passing a predicate Func that will get called with the path to each asset that matches the given type or query.</li>
<li>Setting a specific set of directories to search through.</li>
</ol>
<p>Here's an example</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token comment">// find all assets with GameLevel behaviour,</span><br><span class="token comment">// the "Level" label and only look within</span><br><span class="token comment">// the Assets/Prefabs/Levels directory</span><br><span class="token class-name"><span class="token keyword">var</span></span> levels <span class="token operator">=</span> AssetDatabaseUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>GameLevel<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><br>  <span class="token string">"l:Level"</span><span class="token punctuation">,</span><br>  <span class="token named-parameter punctuation">searchPaths</span><span class="token punctuation">:</span> <span class="token string">"Assets/Prefabs/Levels"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>You can check out the code <a href="https://github.com/troublecatstudios/noir-unity/blob/stable/Editor/AssetDatabaseUtility.cs">here, in the Noir.Unity</a> project and on the <a href="https://troublecatstudios.github.io/noir-unity/api/NoirUnityEditor.AssetDatabaseUtility.html">docs site for the library</a>. It's MIT licensed so please use it or remix it as you need.</p>
<p>Until next time! You can always shoot me your thoughts on <a href="https://www.twitter.com/codeimpossible">twitter.</a></p>

        </div>
            <span style="float: left">
                <span class="uppercase text-xs mt-6">Previous</span>
                <span class="font-bold">
                    <a href="/post/test-structuring-in-c#/">Test Structuring in C#</a>
                </span>
            </span>
        
            <span style="float: right">
                <span class="uppercase text-xs mt-6">Next</span>
                <span class="font-bold mb-2">
                    <a href="/post/pixel-art-emission-maps/">Pixel Art Emission Maps</a>
                </span>
            </span>
        

    </div>

    </main>
    <footer>
  <div class="container mx-auto max-w-3xl flex-grow">
    <div class="grid grid-cols-2 gap-4">
      <div>
        <p class="block text-center text-sm mb-6">
        Release: <a href="https://github.com/codeimpossible/jaredbarboza.me/commit/d905014e57d0514319c168bac651b7532b8dedef">d905014e</a>
        &copy;
        <a target="_blank" href="https://jaredbarboza.me">
          Jared Barboza
        </a> 2022.
        </p>
      </div>
      <div style="text-align: right">
        <ul>
          <li><a href="/license/">License</a></li>
          <li><a href="https://github.com/codeimpossible">GitHub</a></li>
          <li><a href="https://twitter.com/codeimpossible">Twitter</a></li>
          <li><a rel="me" href="https://mastodon.gamedev.place/@Literallyacat">Mastodon</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
    <script src="/assets/main.bundle.js"></script>
    <script type="text/javascript">
      (function(f,b){if(!b.__SV){var e,g,i,h;window.mixpanel=b;b._i=[];b.init=function(e,f,c){function g(a,d){var b=d.split(".");2==b.length&&(a=a[b[0]],d=b[1]);a[d]=function(){a.push([d].concat(Array.prototype.slice.call(arguments,0)))}}var a=b;"undefined"!==typeof c?a=b[c]=[]:c="mixpanel";a.people=a.people||[];a.toString=function(a){var d="mixpanel";"mixpanel"!==c&&(d+="."+c);a||(d+=" (stub)");return d};a.people.toString=function(){return a.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
      for(h=0;h<i.length;h++)g(a,i[h]);var j="set set_once union unset remove delete".split(" ");a.get_group=function(){function b(c){d[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));a.push([e,call2])}}for(var d={},e=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<j.length;c++)b(j[c]);return d};b._i.push([e,f,c])};b.__SV=1.2;e=f.createElement("script");e.type="text/javascript";e.async=!0;e.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
      MIXPANEL_CUSTOM_LIB_URL:"file:"===f.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";g=f.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}})(document,window.mixpanel||[]);

      // Enabling the debug mode flag is useful during implementation,
      // but it's recommended you remove it for production
      mixpanel.init('2d56400048ed4cc12effac63a51e4b4d'); 
      mixpanel.track_links("#nav a", "click nav link", {
        "referrer": document.referrer
      });
      mixpanel.register({
        "uri": "http://blog.barboza.io/post/code-recipe-assetdatabaseutility/"
      });
      
      var engagement_time = 0;
      var logged_view = false;
      setInterval(function() {
        if (!logged_view) {
          mixpanel.track('Content View');
          logged_view = true;
        }
        engagement_time += 10;
        mixpanel.track('Engagement', {
          "engagement_duration": engagement_time
        });
      }, 10000);
    </script>
  </body>
</html>
