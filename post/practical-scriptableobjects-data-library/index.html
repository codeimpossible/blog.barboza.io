<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    
    <meta itemprop="name" content="Practical ScriptableObjects: Data Library | blog.barboza.io">
    <meta itemprop="description" content="üçï P I Z Z A is life">

    
    <meta name="twitter:title" content="Practical ScriptableObjects: Data Library | blog.barboza.io">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="üçï P I Z Z A is life">
    <meta name="twitter:site" content="@codeimpossible">
    <meta name="twitter:creator" content="@codeimpossible">
    <meta name="twitter:image:src" content="http://blog.barboza.io/social-header.png">

    
    <meta name="og:title" content="Practical ScriptableObjects: Data Library | blog.barboza.io">
    <meta name="og:description" content="üçï P I Z Z A is life">
    <meta name="og:image" content="http://blog.barboza.io/social-header-lg.png">
    <meta name="og:url" content="http://blog.barboza.io/">
    <meta name="og:site_name" content="blog.barboza.io">
    <meta name="og:locale" content="en_US">
    <meta name="og:type" content="website">

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <title>Practical ScriptableObjects: Data Library‚Äîblog.barboza.io</title>

    <link rel="stylesheet" href="/assets/main.bundle.css">

    
  </head>
  <body class="flex flex-col min-h-screen is-post">
    <main class="container mx-auto max-w-3xl flex-grow">
      <aside class="intro">
  <a href="/">
    <img src="/me.jpg" alt="Me. I mean Jared. I mean that's me, Jared." class="rounded-full" />
  </a>
  <div class="intro-greeting mb-5">
    <h1>Hey there üëã, I'm Jared.</h1>
    <h2>Future skeleton. üêà parent. Lover of all things üçï. Dispenser of artisanal emoji, gifs and memes. They/Them.</h2>
  </div>
  <span class="social">
      <a href="https://twitter.com/codeimpossible" class="social_icon icon-twitter" title="@codeimpossible on Twitter">
          <svg width="28" height="28" viewBox="0 0 32 32" preserveAspectRatio="xMinYMin" aria-hidden="true" focusable="false">
              <use xlink:href="#icon-twitter">
                  <g id="icon-twitter"><path fill="#00c9ff" d="M 32,6.076c-1.177,0.522-2.443,0.875-3.771,1.034c 1.355-0.813, 2.396-2.099, 2.887-3.632 c-1.269,0.752-2.674,1.299-4.169,1.593c-1.198-1.276-2.904-2.073-4.792-2.073c-3.626,0-6.565,2.939-6.565,6.565 c0,0.515, 0.058,1.016, 0.17,1.496c-5.456-0.274-10.294-2.888-13.532-6.86c-0.565,0.97-0.889,2.097-0.889,3.301 c0,2.278, 1.159,4.287, 2.921,5.465c-1.076-0.034-2.088-0.329-2.974-0.821c-0.001,0.027-0.001,0.055-0.001,0.083 c0,3.181, 2.263,5.834, 5.266,6.438c-0.551,0.15-1.131,0.23-1.73,0.23c-0.423,0-0.834-0.041-1.235-0.118 c 0.836,2.608, 3.26,4.506, 6.133,4.559c-2.247,1.761-5.078,2.81-8.154,2.81c-0.53,0-1.052-0.031-1.566-0.092 c 2.905,1.863, 6.356,2.95, 10.064,2.95c 12.076,0, 18.679-10.004, 18.679-18.68c0-0.285-0.006-0.568-0.019-0.849 C 30.007,8.548, 31.12,7.392, 32,6.076z"></path></g>
              </use>
          </svg>
          <span class="a11y-only">Twitter</span>
      </a> 
      <a href="https://github.com/codeimpossible/" class="social_icon icon-github" title="@codeimpossible on GitHub">
          <svg width="28" height="28" viewBox="0 0 32 32" preserveAspectRatio="xMinYMin" aria-hidden="true" focusable="false">
              <use xlink:href="#icon-github">
                  <g id="icon-github"><path fill="#000000" d="M 16,0C 7.163,0,0,7.163,0,16s 7.163,16, 16,16s 16-7.163, 16-16S 24.837,0, 16,0z M 25.502,25.502 c-1.235,1.235-2.672,2.204-4.272,2.881c-0.406,0.172-0.819,0.323-1.238,0.453L 19.992,26.438 c0-1.26-0.432-2.188-1.297-2.781 c 0.542-0.052, 1.039-0.125, 1.492-0.219s 0.932-0.229, 1.438-0.406s 0.958-0.388, 1.359-0.633s 0.786-0.563, 1.156-0.953s 0.68-0.833, 0.93-1.328 s 0.448-1.089, 0.594-1.781s 0.219-1.456, 0.219-2.289c0-1.615-0.526-2.99-1.578-4.125c 0.479-1.25, 0.427-2.609-0.156-4.078l-0.391-0.047 c-0.271-0.031-0.758,0.083-1.461,0.344s-1.492,0.688-2.367,1.281c-1.24-0.344-2.526-0.516-3.859-0.516c-1.344,0-2.625,0.172-3.844,0.516 c-0.552-0.375-1.075-0.685-1.57-0.93c-0.495-0.245-0.891-0.411-1.188-0.5s-0.573-0.143-0.828-0.164s-0.419-0.026-0.492-0.016 s-0.125,0.021-0.156,0.031c-0.583,1.479-0.635,2.839-0.156,4.078c-1.052,1.135-1.578,2.51-1.578,4.125c0,0.833, 0.073,1.596, 0.219,2.289 s 0.344,1.286, 0.594,1.781s 0.56,0.938, 0.93,1.328s 0.755,0.708, 1.156,0.953s 0.854,0.456, 1.359,0.633s 0.984,0.313, 1.438,0.406 s 0.951,0.167, 1.492,0.219c-0.854,0.583-1.281,1.51-1.281,2.781l0,2.445 c-0.472-0.14-0.937-0.306-1.394-0.5 c-1.6-0.677-3.037-1.646-4.272-2.881c-1.235-1.235-2.204-2.672-2.881-4.272C 2.917,19.575, 2.563,17.815, 2.563,16 s 0.355-3.575, 1.055-5.23c 0.677-1.6, 1.646-3.037, 2.881-4.272s 2.672-2.204, 4.272-2.881 C 12.425,2.917, 14.185,2.563, 16,2.563s 3.575,0.355, 5.23,1.055c 1.6,0.677, 3.037,1.646, 4.272,2.881 c 1.235,1.235, 2.204,2.672, 2.881,4.272C 29.083,12.425, 29.438,14.185, 29.438,16s-0.355,3.575-1.055,5.23 C 27.706,22.829, 26.737,24.267, 25.502,25.502z"></path></g>
              </use>
          </svg>
          <span class="a11y-only">GitHub</span>
      </a> 
      <a href="/feed/" class="social_icon icon-rss" title="Jared Barboza's RSS Feed">
          <svg width="28" height="28" viewBox="0 0 32 32" preserveAspectRatio="xMinYMin" aria-hidden="true" focusable="false">
              <use xlink:href="#icon-feed">
                  <g id="icon-feed"><path fill="#ff9132" d="M 4.259,23.467c-2.35,0-4.259,1.917-4.259,4.252c0,2.349, 1.909,4.244, 4.259,4.244 c 2.358,0, 4.265-1.895, 4.265-4.244C 8.525,25.383, 6.618,23.467, 4.259,23.467zM 0.005,10.873l0,6.133 c 3.993,0, 7.749,1.562, 10.577,4.391c 2.825,2.822, 4.384,6.595, 4.384,10.603l 6.16,0 C 21.125,20.349, 11.648,10.873, 0.005,10.873zM 0.012,0l0,6.136 c 14.243,0, 25.836,11.604, 25.836,25.864L 32,32 C 32,14.36, 17.648,0, 0.012,0z"></path></g>
              </use>
          </svg>
          <span class="a11y-only">RSS</span>
      </a>
  </span>
</aside>
      
    <div>
        <h1>Practical ScriptableObjects: Data Library</h1>

        

        
            <span class="text-sm">üìÜ <em>Created on
                    <span datetime="Mon Jul 10 2023 00:00:00 GMT+0000 (Coordinated Universal Time)">July 10, 2023</span>.</em></span>
        

        
            <span class="pl-10 mb-2 tags">
                <span>üîñ</span>
                <a class="tag tag-inline" href="/tag/unity3d">unity3d</a><a class="tag tag-inline" href="/tag/game-development">game-development</a><a class="tag tag-inline" href="/tag/programming">programming</a>
            </span>
        

        <div class="content post">
            <p>If you haven't checked out the intro to this series yet, you <a href="/post/practical-scriptableobjects">should give it a read now</a>. It has an overview of what I'm setting out to do with this series as well as links to my other posts and excellent resources on ScriptableObjects.</p>
<h2>Whats the problem?</h2>
<p>While building Electric Noir I often needed to reference assets directly from my MonoBehaviour code. The problem is I didn't want to have asset references located in all my Game Objects and prefabs, that would make refactoring or swapping out assets later on a really time consuming task - and this sort of work is always going to happen when making your game, so its worth spending some time on making it easy up front if you can.</p>
<h2>The old ways</h2>
<p>So I had assets like Sprites, Textures, AudioClips, and even Materials that I needed to be able to access via code at runtime. The normal method to do this would be to move all the assets I need at runtime into <code>Resources</code> folders and load them using <code>Resources.Load()</code>. I could also opt to bundle all my assets into Asset Bundles and use <code>AssetBundle.LoadAsset()</code>. Both of these are fine options, but I wanted something that would pull in new assets automatically and provide a simpler API to get the assets I needed.</p>
<h2>Enter the Data Library</h2>
<p>The data library in Electric Noir is a Scriptable Object (as you probably guessed) that holds references to various assets used throughout the game. It's re-built every time the game is built and can be built manually via in-editor Menus. It also provides a very simple API to access resources, so loading a Sprite at runtime can be done via:</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> sprite <span class="token operator">=</span> DataLibrary<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">GetSpriteByName</span><span class="token punctuation">(</span><span class="token string">"ExampleSprite_0_1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>I can also access all the assets of a specific type.</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> allSprites <span class="token operator">=</span> DataLibrary<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>Sprites<span class="token punctuation">;</span></code></pre>
<h2>Basic Implementation</h2>
<p>Let's get started with a basic implementation. Let's define our <code>DataLibrary</code> class and give it some basic properties.</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token comment">// original by Jared Barboza &lt;https://blog.barboza.io></span><br><span class="token comment">// released under MIT licence https://blog.barboza.io/license/</span><br><span class="token comment">//</span><br><span class="token comment">// put this code in a DataLibrary.cs file</span><br><span class="token comment">// make sure to create your DataLibrary asset in a Resources folder</span><br><span class="token punctuation">[</span><span class="token function">CreateAssetMenu</span><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"DataLibrary.asset"</span><span class="token punctuation">,</span> menuName <span class="token operator">=</span> <span class="token string">"Practical ScriptableObjects/Data Library"</span><span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataLibrary</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// Singleton implementation</span><br>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">DataLibrary</span> _instance<span class="token punctuation">;</span><br>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">DataLibrary</span> Instance <span class="token punctuation">{</span><br>        <span class="token keyword">get</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_instance<span class="token punctuation">)</span> _instance <span class="token operator">=</span> Resources<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DataLibrary<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">nameof</span><span class="token punctuation">(</span>DataLibrary<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">return</span> _instance<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Internal caching, makes looking up the same assets repeatedly faster</span><br>    <span class="token keyword">private</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">object</span><span class="token punctuation">></span></span> _lookupCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">object</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">private</span> <span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">GetCachedObject</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> lookup<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> lookupSource<span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token class-name">T</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">UnityEngine<span class="token punctuation">.</span>Object</span></span> <span class="token punctuation">{</span><br>        <span class="token class-name"><span class="token keyword">var</span></span> key <span class="token operator">=</span> <span class="token function">CreateKey</span><span class="token punctuation">(</span>lookup<span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>_lookupCache<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> cached<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> cached <span class="token keyword">as</span> <span class="token class-name">T</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token class-name"><span class="token keyword">var</span></span> item <span class="token operator">=</span> lookupSource<span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>se <span class="token operator">=></span> se<span class="token punctuation">.</span>name <span class="token operator">==</span> lookup<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            _lookupCache<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            Debug<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Lookup for '</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">lookup</span><span class="token punctuation">}</span></span><span class="token string">' of type '</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">' failed. The library will return a default value. This may cause unwanted behaviour."</span></span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> item<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">CreateKey</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token class-name">Type</span> objectType<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">name</span><span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">objectType<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The actual library asset reference properties</span><br>    <span class="token comment">// This is where you can add extend the library with your own List&lt;T> properties</span><br>    <span class="token keyword">public</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Material<span class="token punctuation">></span></span> Materials<span class="token punctuation">;</span><br>    <span class="token keyword">public</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Sprite<span class="token punctuation">></span></span> Sprites<span class="token punctuation">;</span><br>    <span class="token keyword">public</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>AudioClip<span class="token punctuation">></span></span> AudioClips<span class="token punctuation">;</span><br><br>    <span class="token comment">// our helper methods that will make finding objects within the library easier</span><br>    <span class="token keyword">public</span> <span class="token return-type class-name">Sprite</span> <span class="token function">GetSpriteByName</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> spriteName<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">GetCachedObject</span><span class="token punctuation">(</span>spriteName<span class="token punctuation">,</span> Sprites<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">public</span> <span class="token return-type class-name">Sprite</span> <span class="token function">GetMaterialByName</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> materialName<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">GetCachedObject</span><span class="token punctuation">(</span>materialName<span class="token punctuation">,</span> Materials<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">public</span> <span class="token return-type class-name">Sprite</span> <span class="token function">GetAudioClipByName</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> clipName<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">GetCachedObject</span><span class="token punctuation">(</span>clipName<span class="token punctuation">,</span> AudioClips<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>With that file created we can now create a new Data Library by selecting <strong>Create/Practical ScriptableObjects/Data Library</strong> menu item from either the <strong>Assets</strong> editor menu or the right-click menu within the Project View. Once the datalibrary is created we can add the assets to each list manually.</p>
<h2>Adding assets manually? That's lame.</h2>
<p>Yeah, I agree. Let's add an editor script to make this easy. This script will need to use my <code>AssetDatabaseUtility</code> class from my <a href="/post/Code-Recipe-AssetDatabaseUtility/">code recipe post of the same name</a>, so make sure you grab that code and add it to your Editor source files.</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token comment">// original by Jared Barboza &lt;https://blog.barboza.io></span><br><span class="token comment">// released under MIT licence https://blog.barboza.io/license/</span><br><span class="token comment">//</span><br><span class="token comment">// put this code in a RebuildDataLibrary.cs file</span><br><span class="token comment">// make sure to add this to an Editor folder</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RebuildDataLibrary</span> <span class="token punctuation">{</span><br>    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> DataDirectory <span class="token operator">=</span> <span class="token string">"Assets"</span><span class="token punctuation">;</span><br><br>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Tools/Practical ScriptableObjects/Refresh Data Library"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><br>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateDataLibraryMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name"><span class="token keyword">var</span></span> library <span class="token operator">=</span> AssetDatabaseUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DataLibrary<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token named-parameter punctuation">searchPaths</span><span class="token punctuation">:</span> DataDirectory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">UpdateDataLibrary</span><span class="token punctuation">(</span>library<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// this is where the library is actually filled with items from your</span><br>    <span class="token comment">// project. Any time you add a property to the DataLibrary.cs make sure</span><br>    <span class="token comment">// to come here and add a line to populate it with assets</span><br>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateDataLibrary</span><span class="token punctuation">(</span><span class="token class-name">DataLibrary</span> library<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        library<span class="token punctuation">.</span>Materials <span class="token operator">=</span> AssetDatabaseUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Material<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        library<span class="token punctuation">.</span>Sprites <span class="token operator">=</span> AssetDatabaseUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Sprite<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        library<span class="token punctuation">.</span>AudioClips <span class="token operator">=</span> AssetDatabaseUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AudioClip<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        EditorUtility<span class="token punctuation">.</span><span class="token function">SetDirty</span><span class="token punctuation">(</span>library<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The above class adds a menu to the Unity Editor under <strong>Tools/Practical ScriptableObjects</strong> that will assign the existing Materials, Sprites and AudioClips into the data library asset automatically. Let's also add a button to the Data Library inspector so we can rebuild the library when we have it selected in Unity.</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token comment">// original by Jared Barboza &lt;https://blog.barboza.io></span><br><span class="token comment">// released under MIT licence https://blog.barboza.io/license/</span><br><span class="token comment">//</span><br><span class="token comment">// put this code in a DataLibraryInspector.cs file</span><br><span class="token comment">// make sure to add this to an Editor folder</span><br><span class="token punctuation">[</span><span class="token function">CustomEditor</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">DataLibrary</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataLibraryInspector</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">UnityEditor<span class="token punctuation">.</span>Editor</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">private</span> <span class="token return-type class-name">DataLibrary</span> Data <span class="token operator">=></span> <span class="token punctuation">(</span>DataLibrary<span class="token punctuation">)</span>target<span class="token punctuation">;</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnInspectorGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"Refresh Data"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            RebuildDataLibrary<span class="token punctuation">.</span><span class="token function">UpdateDataLibrary</span><span class="token punctuation">(</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token function">DrawDefaultInspector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The final touch is to add a <a href="https://docs.unity3d.com/ScriptReference/Build.IPreprocessBuildWithReport.OnPreprocessBuild.html">build time preprocessor</a> to ensure the data library is always built when we create a build of the game. We definitely don't want to ship a build of the game with an outdated data library!</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token comment">// original by Jared Barboza &lt;https://blog.barboza.io></span><br><span class="token comment">// released under MIT licence https://blog.barboza.io/license/</span><br><span class="token comment">//</span><br><span class="token comment">// put this code in a UpdateDataLibraryPreprocessor.cs file</span><br><span class="token comment">// make sure to add this to an Editor folder</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UpdateDataLibraryPreprocessor</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IPreprocessBuildWithReport</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> callbackOrder <span class="token operator">=></span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnPreprocessBuild</span><span class="token punctuation">(</span><span class="token class-name">BuildReport</span> report<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        RebuildDataLibrary<span class="token punctuation">.</span><span class="token function">UpdateDataLibraryMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h2>Summary</h2>
<p>There's not much code to this solution, which (I hope) makes it really easy to extend and customize. Imagine having different player abilities, loot items, spells, hit effects defined in ScriptableObjects and adding them to this DataLibrary. You could easily spawn hit effects or enable abilities from within your MonoBehaviours without them needing their own copy of the data.</p>
<p>Also extending the data library with new features should be fairly straight forward, like</p>
<ul>
<li>Updating the <code>UpdateDataLibraryPreprocessor</code> to run whenever &quot;Play&quot; is clicked in the editor</li>
<li>Modify <code>RebuildDataLibrary.UpdateDataLibrary()</code> so that it uses reflection to detect the types within each <code>List&lt;T&gt;</code> property and call the <code>AssetDatabaseUtility</code> to populate them. This would make adding properties in the future much simpler.</li>
</ul>

        </div>
            <span style="float: left">
                <span class="uppercase text-xs mt-6">Previous</span>
                <span class="font-bold">
                    <a href="/post/practical-scriptableobjects-intro/">Practical ScriptableObjects: Intro</a>
                </span>
            </span>
        
            <span style="float: right">
                <span class="uppercase text-xs mt-6">Next</span>
                <span class="font-bold mb-2">
                    <a href="/post/unity-breakup/">Unity Breakup</a>
                </span>
            </span>
        

    </div>

    </main>
    <footer>
  <div class="container mx-auto max-w-3xl flex-grow">
    <div class="grid grid-cols-2 gap-4">
      <div>
        <p class="block text-center text-sm mb-6">
        Release: <a href="https://github.com/codeimpossible/jaredbarboza.me/commit/d905014e57d0514319c168bac651b7532b8dedef">d905014e</a>
        &copy;
        <a target="_blank" href="https://jaredbarboza.me">
          Jared Barboza
        </a> 2022.
        </p>
      </div>
      <div style="text-align: right">
        <ul>
          <li><a href="/license/">License</a></li>
          <li><a href="https://github.com/codeimpossible">GitHub</a></li>
          <li><a href="https://twitter.com/codeimpossible">Twitter</a></li>
          <li><a rel="me" href="https://mastodon.gamedev.place/@Literallyacat">Mastodon</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
    <script src="/assets/main.bundle.js"></script>
    <script type="text/javascript">
      (function(f,b){if(!b.__SV){var e,g,i,h;window.mixpanel=b;b._i=[];b.init=function(e,f,c){function g(a,d){var b=d.split(".");2==b.length&&(a=a[b[0]],d=b[1]);a[d]=function(){a.push([d].concat(Array.prototype.slice.call(arguments,0)))}}var a=b;"undefined"!==typeof c?a=b[c]=[]:c="mixpanel";a.people=a.people||[];a.toString=function(a){var d="mixpanel";"mixpanel"!==c&&(d+="."+c);a||(d+=" (stub)");return d};a.people.toString=function(){return a.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
      for(h=0;h<i.length;h++)g(a,i[h]);var j="set set_once union unset remove delete".split(" ");a.get_group=function(){function b(c){d[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));a.push([e,call2])}}for(var d={},e=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<j.length;c++)b(j[c]);return d};b._i.push([e,f,c])};b.__SV=1.2;e=f.createElement("script");e.type="text/javascript";e.async=!0;e.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
      MIXPANEL_CUSTOM_LIB_URL:"file:"===f.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";g=f.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}})(document,window.mixpanel||[]);

      // Enabling the debug mode flag is useful during implementation,
      // but it's recommended you remove it for production
      mixpanel.init('2d56400048ed4cc12effac63a51e4b4d'); 
      mixpanel.track_links("#nav a", "click nav link", {
        "referrer": document.referrer
      });
      mixpanel.register({
        "uri": "http://blog.barboza.io/post/practical-scriptableobjects-data-library/"
      });
      
      var engagement_time = 0;
      var logged_view = false;
      setInterval(function() {
        if (!logged_view) {
          mixpanel.track('Content View');
          logged_view = true;
        }
        engagement_time += 10;
        mixpanel.track('Engagement', {
          "engagement_duration": engagement_time
        });
      }, 10000);
    </script>
  </body>
</html>
